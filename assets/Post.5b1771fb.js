import{m as E,h as P,_ as N,e as z,u as D,U as R,n as h,V,s as W,W as q,p as A,o as l,g as c,w as m,b as H,a as j,y as O,z as U,j as o,l as L,J as S,v as J,T as K,C as M,K as Y,B as G}from"./app.72ce5aa5.js";import{A as I,P as Q}from"./Page.9939502c.js";import{P as X}from"./Pager.705b7ed2.js";import"./resolveTime.bbe121e0.js";const x=({headers:k,activeLink:n})=>{const r=E();return P("ul",{class:{catalog:!0}},k.map(a=>P("li",{class:{active:n===a.slug,[`level-${a.level}`]:!0,[`toc-link-${a.slug}`]:!0},key:a.title,onClick:()=>{r.currentRoute.value.hash!==`#${a.slug}`&&r.push(`#${a.slug}`)}},a.title)))};x.displayName="Catalog";x.props={headers:{type:Object,required:!0},activeLink:{type:String,default:""}};const Z=z({__name:"Post",setup(k){const n=Y(),r=D(),a=E(),_=G(),b=_.resolve,$=_.pending,i=R(),F=h(()=>i.value?n.value.headers:[]),w=t=>t.children.length>0?[t].concat(...t.children.map(w)):t,u=h(()=>[].concat(...F.value.map(w))),e=V({headerHeight:0,screenWidth:0,catalogTop:0,activeLink:"",isFixed:!1}),p=40,y=80,d=()=>{for(let s=u.value.length-1;s>=0;s--){const B=u.value[s].slug,C=document.querySelector(`#${B}`);if((C?C.getBoundingClientRect().top:0)<=100){e.activeLink=B;break}}window.pageYOffset>e.headerHeight+p-y?(e.isFixed=!0,e.catalogTop=y):(e.isFixed=!1,e.catalogTop=e.headerHeight+p)},g=()=>{const t=document.querySelector(".post-header");e.headerHeight=t?t.offsetHeight:0,e.screenWidth=document.body.clientWidth,e.catalogTop=e.headerHeight+p};let T;W(()=>{window.addEventListener("scroll",d),g(),window.onresize=()=>(()=>{g(),d()})(),T=a.afterEach(()=>{g()})}),q(()=>{window.removeEventListener("scroll",d),T()});const{post:v}=A(),f=h(()=>{if(!v.value)return{};const t=v.value.info.next;t&&(t.text=r.value.postNext);const s=v.value.info.prev;return s&&(s.text=r.value.postPrev),{next:t,prev:s}});return(t,s)=>(l(),c(M,null,{page:m(()=>[H(K,{name:"fade-slide-y",mode:"out-in",onBeforeEnter:o(b),onBeforeLeave:o($)},{default:m(()=>[j("div",{class:S(["post-wrapper",{"show-catalog":o(i)}])},[O(H(I,{class:"post-header"},null,512),[[U,o(n).title]]),(l(),c(Q,{key:o(n).path,class:"post-content"},{bottom:m(()=>[o(f).next||o(f).prev?(l(),c(X,{key:0,data:o(f)},null,8,["data"])):L("",!0)]),_:1})),o(i)?(l(),c(o(x),{key:0,headers:o(u),"active-link":e.activeLink,class:S({fixed:e.isFixed}),style:J({top:`${e.catalogTop}px`})},null,8,["headers","active-link","class","style"])):L("",!0)],2)]),_:1},8,["onBeforeEnter","onBeforeLeave"])]),_:1}))}});var ne=N(Z,[["__file","Post.vue"]]);export{ne as default};
