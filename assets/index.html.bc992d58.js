import{_ as s,o as a,c as e,d as t}from"./app.12b3c3fb.js";var p="/assets/ad2d06eab957495bb156bf32ab6b1962.39fd5621.png",n="/assets/b26ad54036e4433aaa2a593d4defaa0a.2c36ac8c.png",i="/assets/2f92146e10794bba9def6195010e25f8.bbaca23b.png";const o={},l=t(`<h2 id="selenium" tabindex="-1"><a class="header-anchor" href="#selenium" aria-hidden="true">#</a> Selenium</h2><p>Selenium \u662F\u4E00\u4E2A Web \u81EA\u52A8\u5316\u6D4B\u8BD5\u5DE5\u5177\uFF0C\u6700\u521D\u662F\u4E3A\u7F51\u7AD9\u81EA\u52A8\u5316\u6D4B\u8BD5\u800C\u5F00\u53D1\uFF0CSelenium \u53EF\u4EE5\u76F4\u63A5\u8C03\u7528\u6D4F\u89C8\u5668\uFF0C\u5B83\u652F\u6301\u6240\u6709\u4E3B\u6D41\u7684\u6D4F\u89C8\u5668\uFF08\u5305\u62EC PhantomJS \u8FD9\u4E9B\u65E0\u754C\u9762\u7684\u6D4F\u89C8\u5668\uFF09\uFF0C\u53EF\u4EE5\u63A5\u6536\u6307\u4EE4\uFF0C\u8BA9\u6D4F\u89C8\u5668\u81EA\u52A8\u52A0\u8F7D\u9875\u9762\uFF0C\u83B7\u53D6\u9700\u8981\u7684\u6570\u636E\uFF0C\u751A\u81F3\u9875\u9762\u622A\u5C4F\u7B49\u3002</p><p>\u6211\u4EEC\u77E5\u9053\uFF0C\u4F20\u7EDF\u7684\u722C\u866B\u901A\u8FC7\u6A21\u62DF HTTP \u8BF7\u6C42\u6765\u722C\u53D6\u7AD9\u70B9\u4FE1\u606F\uFF0C\u7531\u4E8E\u8FD9\u79CD\u65B9\u5F0F\u548C\u6D4F\u89C8\u5668\u8BBF\u95EE\u5DEE\u5F02\u6BD4\u8F83\u660E\u663E\uFF0C\u5F88\u591A\u7AD9\u70B9\u90FD\u4F1A\u91C7\u53D6\u4E00\u4E9B\u53CD\u722C\u7684\u624B\u6BB5\uFF0C\u800C Selenium \u662F\u901A\u8FC7\u6A21\u62DF\u6D4F\u89C8\u5668\u6765\u722C\u53D6\u4FE1\u606F\uFF0C\u5176\u884C\u4E3A\u548C\u7528\u6237\u51E0\u4E4E\u4E00\u6837\uFF0C\u53CD\u722C\u7B56\u7565\u5F88\u96BE\u533A\u5206\u51FA\u8BF7\u6C42\u5230\u5E95\u662F\u6765\u81EA Selenium \u8FD8\u662F\u771F\u5B9E\u7528\u6237\u3002</p><p>\u4E0D\u8FC7 Selenium \u722C\u866B\u4E0D\u8DB3\u4E4B\u5904\u5728\u4E8E\u6162\uFF0C\u5982\u679C\u4F60\u5BF9\u722C\u866B\u7684\u901F\u5EA6\u6CA1\u6709\u8981\u6C42\uFF0C\u6216\u8005\u8BF7\u6C42\u6570\u636E\u6E90\u4F20\u8F93\u8FC7\u7A0B\u52A0\u5BC6\uFF0C\u83B7\u53D6\u7684\u63A5\u53E3\u96BE\u4EE5\u9006\u5411\u89E3\u6790\uFF0C\u53EF\u4EE5\u5C1D\u8BD5\u4F7F\u7528 Selenium \u83B7\u53D6\u6570\u636E\u3002</p><h2 id="\u51C6\u5907\u5DE5\u4F5C" tabindex="-1"><a class="header-anchor" href="#\u51C6\u5907\u5DE5\u4F5C" aria-hidden="true">#</a> \u51C6\u5907\u5DE5\u4F5C</h2><h3 id="\u5B89\u88C5-selenium" tabindex="-1"><a class="header-anchor" href="#\u5B89\u88C5-selenium" aria-hidden="true">#</a> \u5B89\u88C5 Selenium</h3><p>\u63A8\u8350\u76F4\u63A5\u4F7F\u7528 pip3 \u5B89\u88C5\uFF0C\u6267\u884C\u5982\u4E0B\u547D\u4EE4\u5373\u53EF\uFF1A</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>pip3 install selenium
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u8FDB\u5165 Python \u547D\u4EE4\u884C\u4EA4\u4E92\u6A21\u5F0F\uFF0C\u5BFC\u5165\u4E00\u4E0B Selenium \u5305\uFF0C\u5982\u679C\u6CA1\u6709\u62A5\u9519\uFF0C\u5219\u8BC1\u660E\u5B89\u88C5\u6210\u529F\u3002</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>$ python3
&gt;&gt;&gt; import selenium
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="webdriver" tabindex="-1"><a class="header-anchor" href="#webdriver" aria-hidden="true">#</a> WebDriver</h3><p>Selenium \u7684\u6838\u5FC3\u7EC4\u4EF6\u662F WebDriver \uFF0CWebDriver \u53EF\u4EE5\u901A\u8FC7\u8C03\u7528\u6D4F\u89C8\u5668\u63D0\u4F9B\u7684\u539F\u751F\u81EA\u52A8\u5316 API \u6765\u9A71\u52A8\u6D4F\u89C8\u5668\u3002\u4E3B\u6D41\u6D4F\u89C8\u5668\u90FD\u6709\u76F8\u5E94\u7684 WebDriver \uFF0C\u672C\u6B21\u4EE5 Chrome \u6D4F\u89C8\u5668\u4E3A\u4F8B\uFF0C\u83B7\u53D6\u5BF9\u5E94 WebDriver \u53CA\u914D\u7F6E\u3002</p><h4 id="chromedriver-\u9A8C\u8BC1" tabindex="-1"><a class="header-anchor" href="#chromedriver-\u9A8C\u8BC1" aria-hidden="true">#</a> ChromeDriver \u9A8C\u8BC1</h4><p>\u8FDB\u5165 ChromeDriver \u4E0B\u8F7D\u5730\u5740\uFF0C\u83B7\u53D6\u5BF9\u5E94\u7248\u672C ChromeDriver <a href="https://sites.google.com/chromium.org/driver/downloads" target="_blank" rel="noopener noreferrer">ChromeDriver - WebDriver for Chrome</a></p><blockquote><p>ps\uFF1A\u6CE8\u610F\u5BF9\u5E94\u7248\u672C\u53F7\uFF0Cchrome \u5730\u5740\u680F\u8F93\u5165 chrome://version/ \u67E5\u770B\u81EA\u5DF1\u7684 Chrome \u7248\u672C</p></blockquote><p><img src="`+p+`" alt="9c87fb06773b9fd15d2e051b5eb92973.png"></p><p>\u4E0B\u8F7D\u5B8C\u6210\u540E\uFF0C\u5C06 ChromeDriver \u653E\u7F6E\u5230 D \u76D8\u6216\u8005\u4EFB\u610F\u5730\u5740\uFF0C \u4E4B\u540E\u53EF\u4EE5\u8FD0\u884C\u4EE5\u4E0B\u811A\u672C\u9A8C\u8BC1\uFF1A</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep

browser <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>executable_path<span class="token operator">=</span><span class="token string">&quot;D:/chromedriver.exe&quot;</span><span class="token punctuation">)</span>
browser<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;https://www.baidu.com&#39;</span><span class="token punctuation">)</span>
sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
browser<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5982\u679C\u8FD0\u884C\u5B8C\u6BD5\u4E4B\u540E\u5F39\u51FA\u6765\u4E86\u4E00\u4E2A Chrome \u6D4F\u89C8\u5668\u5E76\u52A0\u8F7D\u4E86\u767E\u5EA6\u9875\u9762\uFF0C2 \u79D2\u4E4B\u540E\u5C31\u5173\u95ED\uFF0C\u90A3\u5C31\u8BC1\u660E\u6CA1\u95EE\u9898\u3002</p><p><a href="https://www.selenium.dev/documentation/webdriver/getting_started/install_drivers/" target="_blank" rel="noopener noreferrer">other browser webdriver</a></p><h2 id="\u5B9E\u4F8B" tabindex="-1"><a class="header-anchor" href="#\u5B9E\u4F8B" aria-hidden="true">#</a> \u5B9E\u4F8B</h2><p>\u672C\u6B21\u4EE5\u4E2D\u56FD\u6D77\u5173 <a href="https://ciferquery.singlewindow.cn/" target="_blank" rel="noopener noreferrer">\u8FDB\u53E3\u98DF\u54C1\u5883\u5916\u751F\u4EA7\u4F01\u4E1A\u6CE8\u518C\u4FE1\u606F</a> \u9875\u9762\u4E3A\u4F8B\u3002 <img src="`+n+'" alt="8c29529486ab432557afbb4840577c47.png"></p><h3 id="\u524D\u60C5\u63D0\u8981" tabindex="-1"><a class="header-anchor" href="#\u524D\u60C5\u63D0\u8981" aria-hidden="true">#</a> \u524D\u60C5\u63D0\u8981</h3><p>\u539F\u672C\u4EE5\u4E3A\u8FD9\u4E2A\u9875\u9762\u53EF\u4EE5\u76F4\u63A5\u722C\u53D6\u63A5\u53E3\uFF0C\u5148\u8FDB\u5165\u9875\u9762\uFF0C\u67E5\u770B\u63A5\u53E3\u7ED3\u6784\u3002 \u7136\u540E\u53D1\u73B0\u8FD4\u56DE\u7684\u6570\u636E\u8FDB\u884C\u8FC7\u52A0\u5BC6\u5904\u7406\uFF0C\u65E0\u6CD5\u6B63\u5E38\u663E\u793A\u6570\u636E\u3002\u6240\u4EE5\u8FD9\u4E2A\u9875\u9762\u9002\u5408\u4F5C\u4E3A\u793A\u4F8B\u6A21\u677F\u3002</p><h3 id="\u6B65\u9AA4" tabindex="-1"><a class="header-anchor" href="#\u6B65\u9AA4" aria-hidden="true">#</a> \u6B65\u9AA4</h3><p><img src="'+n+`" alt="8c29529486ab432557afbb4840577c47.png"></p><h4 id="\u83B7\u53D6\u9875\u9762\u6570\u636E" tabindex="-1"><a class="header-anchor" href="#\u83B7\u53D6\u9875\u9762\u6570\u636E" aria-hidden="true">#</a> \u83B7\u53D6\u9875\u9762\u6570\u636E</h4><p>\u89C2\u5BDF\u9875\u9762\u53EF\u77E5\u4E3B\u4F53\u662F\u4E00\u4E2A table \u8868\u683C\uFF0C\u53EA\u9700\u8981\u5B9A\u4F4D\u5230\u5BF9\u5E94\u7684 table \u6807\u7B7E\u5373\u53EF\u4EE5\u83B7\u53D6\u6570\u636E\u6E90\u3002</p><p>\u7531\u4E8E selenium \u66F4\u65B0\u81F3 4.4 \u7248\u672C\u540E<code>find_elements_by_xxx</code>\u63A5\u53E3\u5DF2\u5F03\u7528\uFF0C\u672C\u6B21\u4F7F\u7528<a href="https://www.selenium.dev/documentation/webdriver/elements/finders/" target="_blank" rel="noopener noreferrer">\u65B0\u63A5\u53E3</a>\u83B7\u53D6\u6570\u636E\u3002</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By

fruits <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">&quot;fruits&quot;</span><span class="token punctuation">)</span>
fruit <span class="token operator">=</span> fruits<span class="token punctuation">.</span>find_elements<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CLASS_NAME<span class="token punctuation">,</span><span class="token string">&quot;tomatoes&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+i+`" alt="309b8ec215a48d8137359b493530540a.png"></p><p>\u901A\u8FC7\u89C2\u5BDF\u9875\u9762\u6807\u7B7E\u8282\u70B9\uFF0C\u53EF\u4EE5\u83B7\u53D6 class \u540D\u79F0\u672A fixed-table-body \u6807\u7B7E\u4E0B\u7684 table, \u518D\u4F9D\u6B21\u83B7\u53D6 tr, td \u89E3\u6790\u6784\u5EFA\u5217\u8868\u3002</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">get_page_data</span><span class="token punctuation">(</span>driver<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    html_str: \u5165\u53C2\u53C2\u6570, \u6307\u7684\u662F\u7F51\u9875\u6E90\u7801\uFF0CHTML\u683C\u5F0F\u7684
    &quot;&quot;&quot;</span>
    data_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;\u67E5\u627E\u7F51\u9875\u6E90\u7801\u4E2D\u7684xpath\uFF0C\u627E\u5230\u6BCF\u4E00\u884C\u7684\u4F4D\u7F6E&quot;&quot;&quot;</span>
        <span class="token comment"># el = driver.find_elements_by_xpath(&#39;//div[@class=&quot;fixed-table-container&quot;]//div[@class=&quot;fixed-table-body&quot;]/table/tbody&#39;) api\u5DF2\u68C4\u7528</span>
        tr_list <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_elements<span class="token punctuation">(</span>
            By<span class="token punctuation">.</span>XPATH<span class="token punctuation">,</span> <span class="token string">&#39;//div[@class=&quot;fixed-table-body&quot;]/table/tbody/tr&#39;</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> tr <span class="token keyword">in</span> tr_list<span class="token punctuation">:</span>
            item <span class="token operator">=</span> tr<span class="token punctuation">.</span>find_elements<span class="token punctuation">(</span>By<span class="token punctuation">.</span>XPATH<span class="token punctuation">,</span> <span class="token string">&#39;./td&#39;</span><span class="token punctuation">)</span>
            td_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            <span class="token triple-quoted-string string">&quot;&quot;&quot;\u5339\u914D\u5C0D\u61C9td\u5167\u5BB9\uFF0C\u7121\u5247\u70BA\u7A7A&quot;&quot;&quot;</span>
            <span class="token keyword">for</span> it <span class="token keyword">in</span> item<span class="token punctuation">:</span>
                <span class="token keyword">try</span><span class="token punctuation">:</span>
                    col <span class="token operator">=</span> it<span class="token punctuation">.</span>text
                <span class="token keyword">except</span><span class="token punctuation">:</span>
                    col <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
                td_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>col<span class="token punctuation">)</span>
            data_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>td_list<span class="token punctuation">)</span>
            <span class="token comment"># print(&#39;data_list..&#39;, data_list)</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token keyword">return</span> data_list

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u63A7\u5236\u70B9\u51FB\u4E0B\u4E00\u9875" tabindex="-1"><a class="header-anchor" href="#\u63A7\u5236\u70B9\u51FB\u4E0B\u4E00\u9875" aria-hidden="true">#</a> \u63A7\u5236\u70B9\u51FB\u4E0B\u4E00\u9875</h4><p><code>ActionChains</code> \u7C7B\u8BB0\u5F55\u4E86\u952E\u76D8\u3001\u9F20\u6807\u3001\u7B14\u7B49\u9875\u9762\u65B9\u6CD5\uFF0C\u53EF\u4EE5\u5E2E\u52A9\u4F60\u66F4\u597D\u7684\u64CD\u4F5C\u6D4F\u89C8\u5668\uFF0C\u4F8B\u5982\u4E0B\u9762\u7684\u884C\u4E3A\uFF1A</p><p>\u83B7\u53D6\u4E0B\u4E00\u9875\u7684\u6807\u7B7E\uFF0C\u5E76\u89E6\u53D1<a href="https://www.selenium.dev/documentation/webdriver/actions_api/mouse/" target="_blank" rel="noopener noreferrer">\u70B9\u51FB\u4E8B\u4EF6</a></p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code>clickable <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>
            By<span class="token punctuation">.</span>XPATH<span class="token punctuation">,</span> <span class="token string">&#39;//li[@class=&quot;page-item page-next&quot;]/a&#39;</span><span class="token punctuation">)</span>
ActionChains<span class="token punctuation">(</span>driver<span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span>clickable<span class="token punctuation">)</span><span class="token punctuation">.</span>perform<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u9700\u8981\u6CE8\u610F\u7684\u662F\u70B9\u51FB\u4E0B\u4E00\u9875\u540E\uFF0C\u6709\u4E00\u4E2A\u6570\u636E\u8BF7\u6C42\u7684\u8FC7\u7A0B\uFF0C\u8FD9\u65F6\u5019\u5E94\u8BE5 <a href="https://www.selenium.dev/documentation/webdriver/waits/" target="_blank" rel="noopener noreferrer">\u9690\u5F0F\u7B49\u5F85</a> \u51E0\u79D2\u518D\u722C\u53D6\u6570\u636E\u3002</p><h3 id="\u5B8C\u6574\u793A\u4F8B" tabindex="-1"><a class="header-anchor" href="#\u5B8C\u6574\u793A\u4F8B" aria-hidden="true">#</a> \u5B8C\u6574\u793A\u4F8B</h3><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> re
<span class="token keyword">import</span> time

<span class="token keyword">import</span> openpyxl
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver <span class="token keyword">import</span> ActionChains


<span class="token keyword">def</span> <span class="token function">get_page_data</span><span class="token punctuation">(</span>driver<span class="token punctuation">)</span><span class="token punctuation">:</span>
    data_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;\u67E5\u627E\u7F51\u9875\u6E90\u7801\u4E2D\u7684xpath\uFF0C\u627E\u5230\u6BCF\u4E00\u884C\u7684\u4F4D\u7F6E&quot;&quot;&quot;</span>
        <span class="token comment"># el = driver.find_elements_by_xpath(&#39;//div[@class=&quot;fixed-table-container&quot;]//div[@class=&quot;fixed-table-body&quot;]/table/tbody&#39;) api\u5DF2\u68C4\u7528</span>
        tr_list <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_elements<span class="token punctuation">(</span>
            By<span class="token punctuation">.</span>XPATH<span class="token punctuation">,</span> <span class="token string">&#39;//div[@class=&quot;fixed-table-body&quot;]/table/tbody/tr&#39;</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> tr <span class="token keyword">in</span> tr_list<span class="token punctuation">:</span>
            item <span class="token operator">=</span> tr<span class="token punctuation">.</span>find_elements<span class="token punctuation">(</span>By<span class="token punctuation">.</span>XPATH<span class="token punctuation">,</span> <span class="token string">&#39;./td&#39;</span><span class="token punctuation">)</span>
            td_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            <span class="token triple-quoted-string string">&quot;&quot;&quot;\u5339\u914D\u5C0D\u61C9td\u5167\u5BB9\uFF0C\u7121\u5247\u70BA\u7A7A&quot;&quot;&quot;</span>
            <span class="token keyword">for</span> it <span class="token keyword">in</span> item<span class="token punctuation">:</span>
                <span class="token keyword">try</span><span class="token punctuation">:</span>
                    col <span class="token operator">=</span> it<span class="token punctuation">.</span>text
                <span class="token keyword">except</span><span class="token punctuation">:</span>
                    col <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
                td_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>col<span class="token punctuation">)</span>
            data_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>td_list<span class="token punctuation">)</span>
            <span class="token comment"># print(&#39;data_list..&#39;, data_list)</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token keyword">return</span> data_list

<span class="token keyword">def</span> <span class="token function">write_excel</span><span class="token punctuation">(</span>file_name<span class="token punctuation">,</span> write_list<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    \u5C06\u6BCF\u4E00\u884C\u7684\u6570\u636E\u6C47\u603B\u7684\u6570\u7EC4\uFF0C\u8FDB\u884C\u904D\u5386\uFF0C\u4F9D\u6B21\u5199\u5230excel\u4E2D
    file_name: \u5165\u53C2\u53C2\u6570, \u6307\u7684\u662F\u5199\u5165excel\u7684\u540D\u5B57
    write_list: \u5165\u53C2\u53C2\u6570, \u6307\u7684\u662F\u5199\u5165excel\u7684\u6BCF\u4E00\u884C\u6C47\u603B\u7684\u6570\u7EC4
    &quot;&quot;&quot;</span>
    full_excel <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>
    full_sheet <span class="token operator">=</span> full_excel<span class="token punctuation">.</span>active
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>write_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        full_sheet<span class="token punctuation">.</span>append<span class="token punctuation">(</span>write_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    full_excel<span class="token punctuation">.</span>save<span class="token punctuation">(</span>file_name<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span>
    url <span class="token operator">=</span> <span class="token string">&quot;https://ciferquery.singlewindow.cn/&quot;</span>
    options <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>ChromeOptions<span class="token punctuation">(</span><span class="token punctuation">)</span>
    options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">&#39;--proxy-server=http://127.0.0.1:7890&#39;</span><span class="token punctuation">)</span>
    driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>executable_path<span class="token operator">=</span><span class="token string">&quot;D:/chromedriver.exe&quot;</span><span class="token punctuation">,</span>
                              chrome_options<span class="token operator">=</span>options<span class="token punctuation">)</span>
    driver<span class="token punctuation">.</span>implicitly_wait<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
    driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>

    every_page_result_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment"># \u7A7A\u6570\u7EC4\u63A5\u53D7\u6BCF\u4E00\u9875\u7684\u6240\u6709\u6570\u636E\u884C\u6C47\u603B\u6570\u636E</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;\u5FAA\u73AF\u6BCF\u4E00\u9875\u83B7\u53D6\u6570\u636E&quot;&quot;&quot;</span>
    pages <span class="token operator">=</span> <span class="token number">10</span>
    <span class="token keyword">for</span> index <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> pages <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        every_page_result_list <span class="token operator">=</span> every_page_result_list <span class="token operator">+</span> get_page_data<span class="token punctuation">(</span>driver<span class="token punctuation">)</span>
		<span class="token comment"># \u83B7\u53D6\u4E0B\u4E00\u9875\u6309\u94AE</span>
        clickable <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>
            By<span class="token punctuation">.</span>XPATH<span class="token punctuation">,</span> <span class="token string">&#39;//li[@class=&quot;page-item page-next&quot;]/a&#39;</span><span class="token punctuation">)</span>
        ActionChains<span class="token punctuation">(</span>driver<span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span>clickable<span class="token punctuation">)</span><span class="token punctuation">.</span>perform<span class="token punctuation">(</span><span class="token punctuation">)</span>
        driver<span class="token punctuation">.</span>implicitly_wait<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\u83B7\u53D6\u7B2C{0}\u9875\u6210\u529F...&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;\u8FD9\u91CC\u662F\u6587\u4EF6excel\u5199\u5165\u8DEF\u5F84\uFF0C\u4F60\u53EF\u4EE5\u6307\u5B9A\u4EFB\u610F\u5B58\u5728\u6216\u8005\u4E0D\u5B58\u5728\u7684\u6587\u4EF6&quot;&quot;&quot;</span>
    write_excel<span class="token punctuation">(</span><span class="token string">r&quot;D:\\test.xlsx&quot;</span><span class="token punctuation">,</span> every_page_result_list<span class="token punctuation">)</span>

    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
    driver<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,40),c=[l];function u(r,d){return a(),e("div",null,c)}var v=s(o,[["render",u],["__file","index.html.vue"]]);export{v as default};
